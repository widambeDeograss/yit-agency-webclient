import{c as n,O as P,u as Q,P as $,r as j,a as Z,b as G,x as p,j as e,B as t,S as q}from"./index-ux5oNEAr.js";import{u as z,B as W,A as v,a as g,b as N}from"./avatar-CIvInjWZ.js";import{T as V}from"./textarea-CqIIQUnW.js";import{C as J,b as r}from"./blogs.service-5oYamVvF.js";import{B as X,M as Y}from"./index-DTKnjc4Z.js";import{S as ee}from"./share-2-DJWy7QZA.js";import{r as se,a as ae}from"./index-QOGCGcxl.js";import{C as de}from"./chevron-down-RgS_l78b.js";import"./index-D92uPXsy.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M20.2 6 3 11l-.9-2.4c-.3-1.1.3-2.2 1.3-2.5l13.5-4c1.1-.3 2.2.3 2.5 1.3Z",key:"1tn4o7"}],["path",{d:"m6.2 5.3 3.1 3.9",key:"iuk76l"}],["path",{d:"m12.4 3.4 3.1 4",key:"6hsd6n"}],["path",{d:"M3 11h18v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2Z",key:"ltgou9"}]],le=n("clapperboard",te);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]],re=n("heart",ie);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]],ce=n("reply",ne);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],oe=n("rocket",me);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],xe=n("thumbs-down",he);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],je=n("thumbs-up",ue),T={like:e.jsx(je,{className:"h-4 w-4"}),dislike:e.jsx(xe,{className:"h-4 w-4"}),heart:e.jsx(re,{className:"h-4 w-4"}),rocket:e.jsx(oe,{className:"h-4 w-4"}),clap:e.jsx(le,{className:"h-4 w-4"})},_e=()=>{const{id:d}=P(),c=Q(),o=$(),[h,f]=j.useState(""),[m,u]=j.useState(null),[w,F]=j.useState({}),{isAuthenticated:y}=Z(),k=G(),{data:a,isLoading:H,isError:I,error:C}=z({queryKey:["blog",d],queryFn:()=>r.getBlogDetail(d)}),{data:_,isLoading:L}=z({queryKey:["blog-comments",d],queryFn:()=>r.getBlogComments(d)}),U=p({mutationFn:s=>r.addReactionToBlog(d,s),onSuccess:()=>{o.invalidateQueries({queryKey:["blog",d]}),o.invalidateQueries({queryKey:["blog-comments",d]})}}),E=p({mutationFn:()=>r.removeReactionFromBlog(d),onSuccess:()=>{o.invalidateQueries({queryKey:["blog",d]})}}),B=p({mutationFn:()=>m?r.replyToComment(m,h):r.createBlogComment(d,h),onSuccess:()=>{f(""),u(null),o.invalidateQueries({queryKey:["blog-comments",d]})}}),K=s=>{if(!y){k(q(!0));return}(a==null?void 0:a.user_reaction)===s?E.mutate():U.mutate(s)},O=s=>{F(i=>({...i,[s]:!i[s]}))};return H?e.jsx("div",{className:"max-w-4xl mx-auto py-8 px-4",children:e.jsx(pe,{})}):I?e.jsxs("div",{className:"max-w-4xl mx-auto py-8 px-4",children:[e.jsxs("div",{className:"text-red-500",children:["Error loading blog: ",C instanceof Error?C.message:"Unknown error"]}),e.jsx(t,{onClick:()=>c(-1),className:"mt-4",children:"Go Back"})]}):a?e.jsxs("div",{className:"max-w-4xl mx-auto py-8 px-4",children:[e.jsxs("article",{className:"mb-12",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx(t,{variant:"ghost",onClick:()=>c(-1),children:"← Back to blogs"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(t,{variant:"ghost",size:"icon",children:e.jsx(X,{className:"h-4 w-4"})}),e.jsx(t,{variant:"ghost",size:"icon",children:e.jsx(ee,{className:"h-4 w-4"})})]})]}),e.jsxs("header",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center gap-2 mb-4",children:a.categories.map(s=>e.jsx(W,{variant:"secondary",children:s.name},s.id))}),e.jsx("h1",{className:"text-3xl font-bold mb-4",children:a.title}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(v,{children:[e.jsx(g,{src:a.author.profileImage??void 0}),e.jsx(N,{children:a.author.username.substring(0,2).toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.author.username}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[b(a.published_at||a.created_at)," · ",a.views," views"]})]})]})]}),a.featured_image&&e.jsx("div",{className:"mb-8 rounded-lg overflow-hidden",children:e.jsx("img",{src:a.featured_image,alt:a.title,className:"w-full h-auto max-h-96 object-cover"})}),e.jsx("div",{className:"prose max-w-none dark:prose-invert",children:e.jsx(Y,{remarkPlugins:[ae],rehypePlugins:[se],children:a.content})}),e.jsx("div",{className:"mt-8 pt-6 border-t",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex gap-2",children:Object.entries(T).map(([s,i])=>e.jsx(t,{variant:a.user_reaction===s?"default":"outline",size:"sm",onClick:()=>K(s),children:i},s))}),e.jsx("div",{className:"text-sm text-muted-foreground"})]})})]}),e.jsxs("section",{className:"border-t pt-8",children:[e.jsxs("h2",{className:"text-2xl font-bold mb-6",children:["Comments ",_&&`(${_.count})`]}),e.jsxs("div",{className:"mb-8",children:[e.jsx(V,{placeholder:m?"Write your reply...":"Write a comment...",value:h,onChange:s=>f(s.target.value),className:"mb-2"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[m&&e.jsx(t,{variant:"ghost",onClick:()=>u(null),children:"Cancel"}),e.jsx(t,{onClick:()=>y?B.mutate():k(q(!0)),disabled:!h.trim()||B.isPending,children:m?"Reply":"Comment"})]})]}),L?e.jsxs("div",{className:"space-y-6",children:[e.jsx(D,{}),e.jsx(D,{})]}):e.jsx("div",{className:"space-y-6",children:a==null?void 0:a.comments.map(s=>{var i,S,A;return e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(v,{children:[e.jsx(g,{src:((i=s.author)==null?void 0:i.profileImage)??void 0}),e.jsx(N,{children:((S=s.author)==null?void 0:S.username.substring(0,2).toUpperCase())||"AN"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:((A=s.author)==null?void 0:A.username)||"[deleted]"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:b(s.created_at)})]}),e.jsxs(t,{variant:"ghost",size:"sm",onClick:()=>u(s.id),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"})," Reply"]})]}),e.jsx("p",{className:"mb-4",children:s.content}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex gap-1",children:Object.entries(T).map(([l,x])=>e.jsx(t,{variant:s.user_reaction===l?"default":"ghost",size:"sm",className:"h-8 w-8 p-0",children:x},l))}),s.replies&&s.replies.length>0&&e.jsxs(t,{variant:"ghost",size:"sm",onClick:()=>O(s.id),children:[w[s.id]?e.jsx(J,{className:"h-4 w-4 mr-1"}):e.jsx(de,{className:"h-4 w-4 mr-1"}),s.replies.length," replies"]})]}),w[s.id]&&s.replies&&e.jsx("div",{className:"mt-4 pl-6 border-l-2",children:s.replies.map(l=>{var x,R,M;return e.jsx("div",{className:"py-4 border-b last:border-b-0",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(v,{className:"h-8 w-8",children:[e.jsx(g,{src:((x=l.author)==null?void 0:x.profileImage)??void 0}),e.jsx(N,{children:((R=l.author)==null?void 0:R.username.substring(0,2).toUpperCase())||"AN"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("p",{className:"text-sm font-medium",children:((M=l.author)==null?void 0:M.username)||"[deleted]"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:b(l.created_at)})]}),e.jsx("p",{className:"text-sm",children:l.content})]})]})},l.id)})})]})]})},s.id)})})]})]}):e.jsxs("div",{className:"max-w-4xl mx-auto py-8 px-4",children:[e.jsx("div",{children:"Blog post not found"}),e.jsx(t,{onClick:()=>c(-1),className:"mt-4",children:"Go Back"})]})},b=d=>{const c=new Date(d);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(c)},pe=()=>e.jsxs("div",{className:"animate-pulse",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("div",{className:"h-10 w-32 bg-muted rounded-md"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-8 w-8 bg-muted rounded-full"}),e.jsx("div",{className:"h-8 w-8 bg-muted rounded-full"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("div",{className:"h-6 w-20 bg-muted rounded-full"}),e.jsx("div",{className:"h-6 w-20 bg-muted rounded-full"})]}),e.jsx("div",{className:"h-10 w-3/4 bg-muted rounded-md mb-4"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 bg-muted rounded-full"}),e.jsxs("div",{children:[e.jsx("div",{className:"h-5 w-32 bg-muted rounded-md mb-2"}),e.jsx("div",{className:"h-4 w-48 bg-muted rounded-md"})]})]})]}),e.jsx("div",{className:"h-64 w-full bg-muted rounded-lg mb-8"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-4 w-full bg-muted rounded-md"}),e.jsx("div",{className:"h-4 w-full bg-muted rounded-md"}),e.jsx("div",{className:"h-4 w-3/4 bg-muted rounded-md"})]})]}),D=()=>e.jsx("div",{className:"border rounded-lg p-4 animate-pulse",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"h-10 w-10 bg-muted rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"h-5 w-32 bg-muted rounded-md mb-1"}),e.jsx("div",{className:"h-4 w-24 bg-muted rounded-md"})]}),e.jsx("div",{className:"h-8 w-16 bg-muted rounded-md"})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("div",{className:"h-4 w-full bg-muted rounded-md"}),e.jsx("div",{className:"h-4 w-5/6 bg-muted rounded-md"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-8 w-8 bg-muted rounded-md"}),e.jsx("div",{className:"h-8 w-8 bg-muted rounded-md"}),e.jsx("div",{className:"h-8 w-8 bg-muted rounded-md"})]})]})]})});export{_e as default};
